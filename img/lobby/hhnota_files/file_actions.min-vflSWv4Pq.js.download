define(["require","exports","tslib","external/immutable","external/lodash","react","modules/clean/ajax","modules/clean/browse_interface","modules/clean/cloud_docs/constants","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/async_file_modal_controller","modules/clean/react/async_fileops_modals","modules/clean/react/async_overquota_modal_controller","modules/clean/react/badge","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/client_download_modal","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/clean/react/delorean/data/types","modules/clean/react/extensions/data/types","modules/clean/react/extensions/split_share_button_component","modules/clean/react/extensions/utils","modules/clean/react/file_transfers/lib/api","modules/clean/react/file_transfers/lib/urls","modules/clean/react/file_transfers/lib/utils","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/file_lock/api","modules/clean/react/files_view/types","modules/clean/react/folder_dialog/api","modules/clean/react/folder_dialog/constants","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/react/retrieval_success_banner/util","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/react/starred/browse_exports","modules/clean/search/single_page/data/action_creators","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/store","modules/clean/search/single_page/logger","modules/clean/search/types","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/sharing/views/exp_showcase_share_interstitial","modules/clean/unity/check_file_cache","modules/clean/unity/features","modules/clean/viewer","modules/clean/web_user_action_events","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/react/folder_overview/async_components"],function(e,o,r,s,n,t,i,a,l,c,d,u,h,f,p,_,m,w,S,v,F,g,y,A,b,E,T,N,R,C,L,O,P,B,k,M,I,U,x,D,V,W,q,z,H,Q,G,K,Y,J,j,Z,X,$,ee,oe,re,se,ne,te,ie,ae,le,ce,de,ue){"use strict";function he(e){return e.isDeleted||e.is_unmounted}function fe(e){var o=e.toArray().map(function(e){return e.fq_path});return d.inSameDirectory(o)}function pe(e){var o=e.result,r=e.args,s=e.action_type,n=r.user,t=r.files,i=r.isSearchMode,a=r.source,l=r.viewType,c=r.isSidebar,d=E.countFilesAndFolders(t),u=d.num_files_selected,h=d.num_folders_selected,f=c?ie.ActionSurfaceLogValue.RIGHT_SIDEBAR:ie.ActionSurfaceLogValue.OVERFLOW_MENU;i?X.logResultAction(s,j.resultsList(Z.getStoreForSearch().getState()),o,f):S.logBrowseAction({uid:n.id,source:a,action:s,num_files_selected:u,num_folders_selected:h,view_type:l,result:o,action_surface:f})}function _e(e){var o=e.context,s=e.files,n=e.user,t=e.viewType,i=e.sharingServiceInfo,a=e.extensionsFeatureFlags,l=e.canDisplayFolderSizes,c=void 0!==l&&l,d=e.isSearchMode,u=void 0!==d&&d,h=e.isQueryingFolderSizes,f=e.showAddToShowcase,p=void 0!==f&&f,_=e.showAddFolderToShowcase,m=void 0!==_&&_,w=e.hasShowcaseFreemium,S=void 0!==w&&w,v=e.isSidebar,F=e.showFolderCalcSize,g=void 0!==F&&F,y=e.expFolderHistoryRollbacks,A=void 0!==y&&y,b=e.pinnedItems,E=e.expRewindUpsell,T=e.showAddToTransfer,N=e.showAddFolderToTransfer,R=e.showRequestFiles,C=e.expShowFileLocking,L=void 0!==C&&C,O=r.__assign({},ye);if(o.isInsideArchivedTeamFolder)return O.showDownload=!0,O;var P=s.every(function(e){return!he(e)}),B=!P&&s.every(function(e){return he(e)});return P?me({actions:O,canDisplayFolderSizes:c,expFolderHistoryRollbacks:A,context:o,files:s,sharingServiceInfo:i,extensionsFeatureFlags:a,isQueryingFolderSizes:h,isSearchMode:u,showAddToShowcase:p,showAddFolderToShowcase:m,hasShowcaseFreemium:S,isSidebar:v,showFolderCalcSize:g,user:n,viewType:t,pinnedItems:b,expRewindUpsell:E,showAddToTransfer:T,showAddFolderToTransfer:N,showRequestFiles:R,expShowFileLocking:L}):B?we({actions:O,files:s,context:o,user:n}):O}function me(e){var o,r=e.actions,s=e.context,n=e.files,t=e.user,i=e.viewType,a=e.sharingServiceInfo,c=e.extensionsFeatureFlags,h=e.canDisplayFolderSizes,f=void 0!==h&&h,p=e.isQueryingFolderSizes,_=void 0!==p&&p,m=e.isSearchMode,w=void 0!==m&&m,S=e.showAddToShowcase,v=void 0!==S&&S,F=e.showAddFolderToShowcase,g=void 0!==F&&F,y=e.hasShowcaseFreemium,A=void 0!==y&&y,b=(e.isSidebar,e.showFolderCalcSize),E=void 0!==b&&b,N=e.expFolderHistoryRollbacks,C=void 0!==N&&N,L=e.pinnedItems,P=e.expRewindUpsell,B=void 0===P?R.UpsellVariant.OFF:P,k=e.showAddToTransfer,M=void 0!==k&&k,I=e.showAddFolderToTransfer,U=void 0!==I&&I,D=e.showRequestFiles,V=void 0!==D&&D,W=e.expShowFileLocking,q=void 0!==W&&W,z=n.first(),H=1===n.count(),Q=H&&!z.is_dir,G=H&&z.is_dir,Y=n.every(function(e){return e.type===u.FileTypes.FILE}),J=n.some(function(e){return e.type===u.FileTypes.TEAM_SHARED_FOLDER}),j=n.some(function(e){return e.type===u.FileTypes.TEAM_MEMBER_FOLDER}),Z=n.some(function(e){return e.type===u.FileTypes.SANDBOX}),X=n.some(function(e){return e instanceof T.FileSharedWithMe}),$=n.some(function(e){return e.is_cloud_doc}),oe=n.some(function(e){return e.is_cloud_doc&&e instanceof T.FileSharedWithMe}),re=!1;if(X||J||j||(r.showCopy=!0,r.showDelete=!0,r.showMove=!0,r.showRename=H),!X&&J&&G&&t&&ee.GoldenGate.hasContentManagerAndSuperAdmin(t.id)&&(r.showRenameTeamFolder=!0,r.showArchive=!0),!X&&!te.Viewer.get_viewer().is_assume_user_session&&t&&ee.GoldenGate.hasContentManagerAndSuperAdmin(t.id)&&ee.GoldenGate.hasNewOwnershipModel(t.id)&&s.isInsideTeamFolderTree&&(r.showManageAsAdmin=!0),H){var ie=n.first();o=ee.shouldUsePublicFolderSharing(s.config,ie.fq_path),X||o||j||Z||(r.showTiburonShare=!0),re=!X&&ne.UnityFeatures.isUnitySupported()&&null!=se.default&&se.default.is_cached_and_locally_available(ie.ns_id,ie.ns_path),re&&(r.showOpen=!0),X||(r.showOpenWith=!0),!X&&c&&a&&O.shouldShowSplitShare(c,a,ie)&&(r.showSplitShare=!0)}if(!X&&G&&(C||B!==R.UpsellVariant.OFF&&B!==R.UpsellVariant.CONTROL)&&(r.showRewindFolder=!0),r.showShowInFolder=!X&&w&&fe(n),Q&&(r.showComment=!z.is_cloud_doc,r.showVersions=!(X||z.is_cloud_doc&&l.isPointerByExtension(z.ns_path)),s.isInFolderMode?r.showCopyPublicFolderFileLink=!!o:r.showCopyPublicFolderFileLink=!1),Q)if(z.is_locked)z.is_lockholder?r.showFileUnlock=!0:r.showFileRequestUnlock=!0;else if(q){var ae=z.ns_id!==t.home_ns_id,le=z.read_only||z.is_symlink||!ae;r.showFileLock=!le}if(re||(r.showDownload=Q?!$:!X&&!oe&&(s.isInFolderMode||w)),!X&&(Y||g&&G)&&s.isCurrentPathWriteable()){var ce=n.some(function(e){return e.is_cloud_doc});!v||A||ce||(r.showProfessionalCollectionShare=!0)}if(r.showAddToTransfer=M&&r.showCopy&&!$&&(Y||U)&&s.isCurrentPathWriteable(),r.showRequestFiles=V&&G&&s.isCurrentPathWriteable()&&!T.File.isReadOnlySharedFolder(z),!X&&H){var de=n.first().type;de!==u.FileTypes.SHARED_FOLDER&&de!==u.FileTypes.TEAM_SHARED_FOLDER||(r.showSharedFolderEvents=!0),G&&null==n.first().fetchFolderSizesStatus&&!_&&!w&&i!==x.ViewType.Grid&&f&&(r.showCalculateFolderSize=!0)}if(!X&&E){var ue=n.every(function(e){return null==e.fetchFolderSizesStatus}),he=n.every(function(e){return e.is_dir}),pe=n.some(function(e){return!T.File.canViewFileMembers(e,s)});ue&&he&&!pe&&!_&&!w&&i!==x.ViewType.Grid&&f&&(r.showCalculateFolderSize=!0)}if(!X&&H){var _e={id:n.first().file_id,type:K.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID},me=K.StarredStore.getIsLoading(_e),we=K.StarredStore.getIsStarred(_e);r.showStar=we===!1,r.showUnstar=we===!0,r.showLoadingStar=me}if(!X&&void 0!==L&&!w){var Se=n.toArray().filter(function(e){return L.some(function(o){return o.fq_path===e.fq_path||o.file_id===e.file_id})}).length;s.isCurrentPathWriteable()&&(r.showUnpin=Se===n.size,r.showPin=Se<n.size),r.showPinTo=d.normalize(s.currentFQPath).split("/").length>1}return r}function we(e){var o=e.actions,r=e.files,s=e.context,n=e.user,t=r.first();if(r.some(function(e){return e.is_unmounted||e.ns_id!==t.ns_id}))return o;1===r.count()&&t.is_dir&&s.inactiveNSIDByFQPath[t.fq_path.toLowerCase()]&&!s.isInsideTeamFolderTree?o.showReadd=!0:o.showRestore=!0;var i;if(s.isInFolderMode)i=s.permanentDeletionDisabledStateByNSID[s.currentNSID];else{i=r.map(function(e){return e.ns_id}).some(function(e){return s.permanentDeletionDisabledStateByNSID[e]})}return!te.Viewer.get_viewer().is_assume_user_session&&n&&ee.GoldenGate.hasContentManagerAndSuperAdmin(n.id)&&ee.GoldenGate.hasNewOwnershipModel(n.id)&&s.isInsideTeamFolderTree&&(o.showManageAsAdmin=!0),i||(o.showPermanentDelete=!0),o}function Se(e,o){var r=o.user,s=o.context,n=o.firstFile,t=o.isSearchMode,a=o.useSearchSuccessBanner,l=o.expBrowseSuccessBanner;if(pe({result:n,args:o,action_type:ie.WebUserActionLogEvent.SHARE}),Xe(a,t,l,ie.WebUserActionLogEvent.SHARE),e.autoShareLink){var c=new de.URI({path:"/sm/create"+d.normalize(n.fq_path)});c.updateQuery("_subject_uid",r.id.toString()),c.updateQuery("redirect","0");var u=function(e){le.redirect(e)};i.WebRequest({url:c.toString(),type:"POST",success:u})}else{var h=function(){ee.asyncShowShareModal(r,n,{browseContext:s,origin:oe.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},N.browseNavActions.setPath,N.browseNavActions.setUrl)};o.showShowcaseInterstitialExp?re.showShowcaseInterstitial({user:r,onClickShare:h,onClickShowcase:Re(o,o.hasCreatedShowcase,o.hasShowcaseFreemium,!0)}):h()}}function ve(e){return function(){var o=e.firstFile,r=o.ns_id,s=o.ns_path;le.redirect("/requests?ns_id="+r+"&path="+s+"&referrer=web_browse_file_action")}}function Fe(e){var o=e.files,r=e.context,s=e.user,n=e.responsive,i=e.sharingServiceInfo,a=e.extensionsFeatureFlags,l=e.canDisplayFolderSizes,u=void 0!==l&&l,h=e.actionHandlers,p=e.skipSharing,_=void 0!==p&&p,m=e.source,S=e.viewType,v=e.isOverFreeQuota,F=void 0!==v&&v,g=e.hasExcludedNsIds,y=void 0!==g&&g,E=e.isSearchMode,N=void 0!==E&&E,P=e.isQueryingFolderSizes,B=void 0!==P&&P,k=e.canShowUJPopup,M=void 0!==k&&k,I=e.showAddToShowcase,U=void 0!==I&&I,x=e.showAddFolderToShowcase,D=void 0!==x&&x,V=e.hasCreatedShowcase,W=void 0!==V&&V,q=e.hasShowcaseFreemium,z=void 0!==q&&q,H=e.isSidebar,Q=void 0!==H&&H,G=e.showShowcaseInterstitialExp,K=void 0!==G&&G,Y=e.showFolderCalcSize,j=void 0!==Y&&Y,X=e.useSearchSuccessBanner,ee=void 0!==X&&X,oe=e.expBrowseSuccessBanner,re=void 0===oe?$.BrowseSuccessBannerVariants.OFF:oe,se=e.expListSubfoldersWithOdyssey,ne=void 0!==se&&se,te=e.pinnedItems,ie=e.expFolderHistoryRollbacks,ae=void 0!==ie&&ie,le=e.expRewindUpsell,de=void 0===le?R.UpsellVariant.OFF:le,ue=e.showAddToTransfer,he=void 0!==ue&&ue,fe=e.showAddFolderToTransfer,pe=void 0!==fe&&fe,me=e.showRequestFiles,we=void 0!==me&&me,Se=e.expShowFileLocking,Fe=void 0!==Se&&Se,ge=(e.expDeleteUseApiV2,e.expCopyUseApiV2),ye=void 0!==ge&&ge,be=e.expMoveUseApiV2,Xe=void 0!==be&&be,$e=o.first(),to=!r.isCurrentPathWriteable()||o.some(function(e){return e.read_only}),io=to,ao=to,lo=to,co=to,uo=o.some(function(e){return!T.File.canViewFileMembers(e,r)}),ho=uo,fo=uo,po=o.every(T.File.isNoAccessSharedFolder),_o=po,mo=po,wo=po,So=o.some(T.File.isNoAccessSharedFolder),vo=!n.isMatchedMedium&&!n.isMatchedLarge,Fo=_e({files:o,context:r,user:s,viewType:S,sharingServiceInfo:i,extensionsFeatureFlags:a,canDisplayFolderSizes:u,isQueryingFolderSizes:B,isSearchMode:N,showAddToShowcase:U,showAddFolderToShowcase:D,hasShowcaseFreemium:z,isSidebar:Q,expFolderHistoryRollbacks:ae,showFolderCalcSize:j,pinnedItems:te,expRewindUpsell:de,showAddToTransfer:he,showAddFolderToTransfer:pe,showRequestFiles:we,expShowFileLocking:Fe}),go=new Array,yo=null===re?$.BrowseSuccessBannerVariants.OFF:re,Ao={user:s,context:r,actionHandlers:h,files:o,firstFile:$e,isSearchMode:N,source:m,viewType:S,hasCreatedShowcase:W,hasShowcaseFreemium:z,showShowcaseInterstitialExp:K,useSearchSuccessBanner:ee,expBrowseSuccessBanner:yo,isSidebar:Q,expListSubfoldersWithOdyssey:ne,expMoveUseApiV2:Xe,expCopyUseApiV2:ye};if(!_&&Fo.showTiburonShare){var bo=ho;Q&&!N&&!vo&&Fo.showSplitShare&&a&&i&&O.shouldShowSplitShare(a,i,$e)?go.push(function(){return t.default.createElement(L.SplitShareButton,{file:$e,user:s,variant:"primary",triggerType:C.TriggerType.SidebarPrimaryButton,onShowShare:Te(Ao),onPresentInZoom:eo(Ao),context:{surface:N?"search":"browse"}})}):vo?go.push({label:ce._("Share link"),performAction:Ee(Ao),disabled:bo,className:"action-share-link",iconName:"link",key:"share-link"}):go.push({label:ce._("Share"),iconName:"link",performAction:Ne(Ao),disabled:bo,className:"action-share",key:"share"})}if(Fo.showCopyPublicFolderFileLink&&go.push({label:ce._("Copy public link"),iconName:"link",className:"action-world-link",performAction:Ce(Ao),key:"copy-public-link"}),Fo.showOpen&&go.push({label:ce._("Open"),performAction:Le(Ao),iconName:"open-in-app",className:"action-open-in-app",key:"open"}),Fo.showShowInFolder&&go.push({label:ce._("Show in folder"),performAction:Ae(Ao),iconName:"open-in-app",className:"action-show-in-folder",key:"show-in-folder"}),Fo.showDownload&&go.push({label:ce._("Download"),performAction:Oe({canShowUJPopup:M,args:Ao}),disabled:_o,iconName:"download",className:"action-download",key:"download"}),Fo.showOpenWith){var Eo=void 0;if(N){var To=Z.getStoreForSearch(),No=J.searchBarExperiments(To.getState());Eo=No.expSearchDetailsPaneVariants}else{var To=b.getStoreForBrowse(),No=A.experiments(To.getState());Eo=No.expBrowseDetailsPaneVariants}var Ro=Eo===$.DetailsPaneVariants.FOLDER_OVERVIEW||Eo===$.DetailsPaneVariants.CONTENT_SCROLL||Eo===$.DetailsPaneVariants.CREATE_FILE_LABEL?C.TriggerType.SecondaryButton:C.TriggerType.SidebarLink;go.push(function(){return t.default.createElement(f.ExtensionsMenu,{user:s,file:$e,triggerType:Ro,telemetryContext:{surface:"sidebar"},key:"extensions-"+$e.fq_path})})}if(Fo.showAddToTransfer&&go.push({label:ce._("Send with Transfer"),performAction:oo(Ao),iconName:"add-to-collection"}),Fo.showRequestFiles&&go.push({label:ce._("Request files"),performAction:ve(Ao),iconName:"new-file-request"}),Fo.showProfessionalCollectionShare){var Co=ce._("Add to showcase");go.push({label:Co,iconName:"add-to-collection",performAction:Re(Ao,W),className:"action-add-to-collection",badge:void 0,key:"add-to-showcase"})}if(Fo.showComment&&go.push({label:ce._("Add comment"),performAction:Pe(Ao),iconName:"add-comment",className:"action-add-comment",key:"add-comment"}),Fo.showStar?go.push({label:ce._("Star",{comment:'Verb describing the "starring" action, not the noun.'}),ariaLabel:ce._("Add to Starred"),ariaPressed:!1,performAction:Be({isStarred:!0,args:Ao}),iconName:"star",className:"action-star",key:"star"}):Fo.showUnstar&&go.push({label:ce._("Unstar",{comment:'Verb describing the "unstarring" action.'}),ariaLabel:ce._("Add to Starred"),ariaPressed:!0,performAction:Be({isStarred:!1,args:Ao}),iconName:"unstar",className:"action-unstar",key:"star"}),Fo.showFileLock&&go.push({label:ce._("Lock editing"),performAction:ro(Ao),key:"file-lock",iconName:"permissions",badge:{variant:w.BadgeVariant.BETA,color:w.BadgeColor.PINK}}),Fo.showFileUnlock&&go.push({label:ce._("Unlock editing"),performAction:so(Ao),key:"file-lock",iconName:"permissions",badge:{variant:w.BadgeVariant.BETA,color:w.BadgeColor.PINK}}),Fo.showFileRequestUnlock&&go.push({label:ce._("Ask to unlock"),performAction:no(Ao),key:"file-lock",iconName:"permissions",badge:{variant:w.BadgeVariant.BETA,color:w.BadgeColor.PINK}}),Fo.showVersions&&(void 0===Ao.firstFile.is_versionable||Ao.firstFile.is_versionable)&&go.push({label:ce._("Version history"),performAction:ze(Ao),iconName:"view-version-history",className:"action-view-version-history",key:"version-history"}),Fo.showRewindFolder&&go.push({label:ce._("Rewind",{project:"folder-history"}),performAction:We(Ao),iconName:"revert-folder",className:"action-revert-folder",key:"rewind"}),Fo.showRename&&go.push({label:ce._("Rename"),performAction:ke(Ao),iconName:"rename",className:"action-rename",disabled:ao,key:"rename"}),Fo.showRenameTeamFolder&&go.push({label:ce._("Rename"),performAction:Me(Ao),iconName:"rename",className:"action-rename",key:"rename-team-folder"}),Fo.showArchive&&go.push({label:ce._("Archive"),performAction:Ie(Ao),iconName:"delete",className:"action-delete",key:"archive"}),Fo.showMove){var Lo=F&&!y?De():Ue(Ao);go.push({label:ce._("Move"),performAction:Lo,disabled:lo,iconName:"move",className:"action-move",key:"move"})}if(Fo.showCopy){var Oo=F&&!y?De():xe(Ao);go.push({label:ce._("Copy"),performAction:Oo,disabled:mo,iconName:"copy",className:"action-copy",key:"copy"})}return Fo.showDelete&&go.push({label:ce._("Delete"),performAction:He(Ao),disabled:io,iconName:"delete",className:"action-delete",key:"delete"}),Fo.showRestore&&go.push({label:ce._("Restore"),className:"action-restore",performAction:Ve({args:Ao}),disabled:co,key:"restore"}),Fo.showReadd&&go.push({label:ce._("Re-add shared folder"),className:"action-re-add",performAction:qe(Ao),disabled:co,key:"re-add-shared-folder"}),Fo.showPermanentDelete&&go.push({label:ce._("Permanently delete"),iconName:"delete",className:"action-permanently-delete",performAction:Qe(Ao),key:"permanently-delete"}),Fo.showSharedFolderEvents&&go.push({label:ce._("Events"),performAction:Ge(Ao),disabled:fo,iconName:"events",className:"action-events",key:"events"}),Fo.showCalculateFolderSize&&go.push({label:ce._("Calculate size"),performAction:Ke(Ao,{showFolderCalcSize:j}),disabled:wo,iconName:"calculate",className:"action-calculate-folder-size",key:"calculate-size"}),Fo.showManageAsAdmin&&go.push({label:ce._("View in admin console"),performAction:Ye(Ao),iconName:"settings-gear",key:"view-in-admin-console"}),Fo.showPin&&go.push({label:ce._("Pin to %(path)s").format({path:c.Emstring.em_snippet(d.filename(r.currentFQPath),8,1)}),performAction:Je(Ao),iconName:"pin",disabled:So,key:"pin-to"}),Fo.showUnpin&&go.push({label:ce._("Unpin"),performAction:Ze(Ao),iconName:"pin",disabled:So,key:"unpin"}),Fo.showPinTo&&go.push({label:ce._("Pin to..."),performAction:je(Ao),iconName:"pin",disabled:So,key:"pin-to-path"}),go}var ge=this;Object.defineProperty(o,"__esModule",{value:!0}),s=r.__importStar(s),n=r.__importStar(n),t=r.__importDefault(t),i=r.__importStar(i),d=r.__importStar(d),p=r.__importStar(p),_=r.__importStar(_),m=r.__importStar(m),S=r.__importStar(S),A=r.__importStar(A),E=r.__importStar(E),I=r.__importStar(I),U=r.__importStar(U),W=r.__importStar(W),J=r.__importStar(J),j=r.__importStar(j),se=r.__importDefault(se),le=r.__importStar(le);var ye={showProfessionalCollectionShare:!1,showTiburonShare:!1,showCopyPublicFolderFileLink:!1,showOpen:!1,showOpenWith:!1,showDownload:!1,showComment:!1,showDelete:!1,showArchive:!1,showRemove:!1,showRename:!1,showRenameTeamFolder:!1,showMove:!1,showCopy:!1,showVersions:!1,showRewindFolder:!1,showRestore:!1,showReadd:!1,showPermanentDelete:!1,showRemoveAccess:!1,showShowInFolder:!1,showStar:!1,showUnstar:!1,showLoadingStar:!1,showSharedFolderEvents:!1,showCalculateFolderSize:!1,showManageAsAdmin:!1,showPin:!1,showPinTo:!1,showUnpin:!1,showSplitShare:!1,showAddToTransfer:!1,showAddFolderToTransfer:!1,showRequestFiles:!1,showFileLock:!1,showFileUnlock:!1,showFileRequestUnlock:!1},Ae=function(e){var o=e.user,r=e.files,s=e.firstFile,n=r.map(function(e){return e.fq_path}).toArray();return function(){var r=n.map(function(e){return d.filename(e)}),t=d.parent_dir(n[0]),i=a.browse_uri_for_fq_path(o,t);r.length>1?i.updateQuery({select_multi:JSON.stringify(r)}):i.updateQuery({select:r[0]}),pe({result:s,args:e,action_type:ie.WebUserActionLogEvent.SHOW_IN_FOLDER}),window.open(i.toString(),"_blank")}},be=function(e){return function(){Se({autoShareLink:!1},e)}},Ee=function(e){return function(){Se({autoShareLink:!0},e)}},Te=be,Ne=function(o){var s=be(o);return function(){return r.__awaiter(ge,void 0,void 0,function(){var n,t,i;return r.__generator(this,function(a){switch(a.label){case 0:return s(),o.isSidebar?[4,new Promise(function(o,r){e(["modules/clean/react/app_actions/telemetry_client"],o,r)}).then(r.__importStar)]:[2];case 1:return n=a.sent(),t=n.createTelemetryClient,i=n.getPiiSafeExtension,t({component:"share-btn"}).session({surface:o.isSearchMode?"search":"browse",ext:i(o.firstFile.ext)}).event("click_share",{trigger_type:C.TriggerType.SidebarPrimaryButton}),[2]}})})}},Re=function(o,s,n,t){return function(){var t=o.user,i=o.files,a=o.firstFile,l=o.source,c=o.viewType,d=E.countFilesAndFolders(o.files),u=d.num_files_selected,h=d.num_folders_selected;if(S.logOpenAddToCollectionModal({uid:t.id,source:l,view_type:c,result:a,num_files_selected:u,num_folders_selected:h}),i.count()>=1){var f=i.map(function(e){return{ns_id:e.ns_id,ns_path:e.ns_path,fq_path:e.fq_path}}).toArray();new Promise(function(o,r){e(["modules/clean/react/professional_collection/add_to_collection_modal_controller"],o,r)}).then(r.__importStar).then(function(e){(0,e.showAddToCollectionModal)(f,t,s,n)})}}},Ce=function(e){return function(){var o=e.user,r=e.context,s=e.firstFile;if(r.config&&s&&s.fq_path){var n=ee.makePublicFolderLink(o.id,r.config,s.fq_path,s.is_dir);n&&ee.showPublicFolderLinkModal(n)}}},Le=function(e){return function(){var o=e.user,r=e.firstFile;pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.OPEN_DESKTOP}),ne.UnityFeatures.open_file(r.ns_id,r.ns_path,o.id,ne.UnityFeatures.standard_open_file_handler,function(){return ne.UnityFeatures.standard_open_file_handler(!1)})}},Oe=function(e){var o=e.canShowUJPopup,r=e.args;return function(){var e=r.user,s=r.context,n=r.files,t=r.firstFile,i=r.isSearchMode,a=r.useSearchSuccessBanner,l=r.expBrowseSuccessBanner;pe({result:t,args:r,action_type:ie.WebUserActionLogEvent.DOWNLOAD}),Xe(a,i,l,ie.WebUserActionLogEvent.DOWNLOAD),v.browseActions.downloadFiles({files:n,context:s,user:e}),o&&F.maybeShowClientDownloadModal(!0)}},Pe=function(e){return function(){var o=e.firstFile,r=e.isSearchMode,s=e.useSearchSuccessBanner,n=e.expBrowseSuccessBanner;pe({result:o,args:e,action_type:ie.WebUserActionLogEvent.ADD_COMMENT}),$e(s,r,n,ie.WebUserActionLogEvent.ADD_COMMENT),e.actionHandlers.onShowComment(o)}},Be=function(e){var o=e.isStarred,r=e.args;return function(){var e=r.user,s=r.firstFile,n=r.isSearchMode,t=r.useSearchSuccessBanner,i=r.expBrowseSuccessBanner;pe({result:s,args:r,action_type:o?ie.WebUserActionLogEvent.STAR:ie.WebUserActionLogEvent.REMOVE_STAR}),Xe(t,n,i,ie.WebUserActionLogEvent.STAR),K.StarredActions.update(e.role,s.file_id,K.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,o)}},ke=function(e){return function(){var o=e.actionHandlers,r=e.firstFile,s=e.isSearchMode,n=e.useSearchSuccessBanner,t=e.expBrowseSuccessBanner;pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.RENAME}),Xe(n,s,t,ie.WebUserActionLogEvent.RENAME),o.onShowRename(r)}},Me=function(e){return function(){var o=e.files;pe({result:e.firstFile,args:e,action_type:ie.WebUserActionLogEvent.RENAME}),p.showContentManagerBridge(o.toArray(),"rename",te.Viewer.get_viewer().team_is_limited)}},Ie=function(e){return function(){var o=e.files;pe({result:e.firstFile,args:e,action_type:ie.WebUserActionLogEvent.ARCHIVE}),p.showContentManagerBridge(o.toArray(),"archive",te.Viewer.get_viewer().team_is_limited)}},Ue=function(e){return function(){var o=e.user,t=e.context,i=e.files,a=e.firstFile,l=e.source,c=e.isSearchMode,d=e.viewType,u=e.useSearchSuccessBanner,f=e.expBrowseSuccessBanner,p=e.expListSubfoldersWithOdyssey,m=e.expMoveUseApiV2,w=i.toArray();pe({result:a,args:e,action_type:ie.WebUserActionLogEvent.OPEN_MOVE_MODAL}),Xe(u,c,f,ie.WebUserActionLogEvent.OPEN_MOVE_MODAL);var F={user:o,files:w,path:c?void 0:t.currentFQPath,onSuccess:function(e,r){if(c&&r){var n=Z.getStoreForSearch();n.dispatch(Y.updateResults({results:r})),n.dispatch(Y.setSelection({selection:new Q.Selection({selected:s.OrderedSet(r.map(function(e){return e.fq_path})),anchor:null})}))}else if(r){var n=b.getStoreForBrowse(),t=A.unsortedFiles(n.getState());r.forEach(function(e){var o=t.find(function(o){return o.file_id===e.file_id});o&&(t=t.remove(o.fq_path))}),n.dispatch(y.setUnsortedFiles({unsortedFiles:t}))}var u=E.countFilesAndFolders(i),h=u.num_files_selected,f=u.num_folders_selected;S.logMoveFiles({uid:o.id,source:l,view_type:d,result:a,num_files_selected:h,num_folders_selected:f})},onRequestNotSent:function(){v.browseActions.selectFilesByFqPath({fqPathsToSelect:w.map(function(e){return e.fq_path})})},onUndo:function(e){if(c&&e){var o=Z.getStoreForSearch();o.dispatch(Y.updateResults({results:w})),o.dispatch(Y.setSelection({selection:new Q.Selection({selected:s.OrderedSet(w.map(function(e){return e.fq_path})),anchor:null})}))}v.browseActions.selectRowsFromBoltClient(w)}},g=p?D.getFolderContentsAPIv2:D.getFolderContents;_.showMoveDialog({operation:V.Operation.MOVE,modalName:h.ModalName.MOVE,user:o,apiClient:{moveToFolder:function(e){var o=r.__assign({},F,{newPath:e,checkFSWs:!0,useApiV2:m});return I.moveFiles(o),Promise.resolve()},getFolderContents:g,getFolderSuggestion:D.getFolderSuggestion},entries:w,initialFolderSelection:t.currentFQPath,onSuccess:n.noop,onCancel:n.noop,showFolderSuggestion:!0,createNewFolderInMoveDialog:!0})}},xe=function(e){return function(){var o=e.user,s=e.files,t=e.firstFile,i=e.isSearchMode,a=e.source,l=e.viewType,c=e.context,d=e.useSearchSuccessBanner,u=e.expBrowseSuccessBanner,f=e.expListSubfoldersWithOdyssey,p=e.expCopyUseApiV2,m=s.toArray();pe({result:t,args:e,action_type:ie.WebUserActionLogEvent.OPEN_COPY_MODAL}),Xe(d,i,u,ie.WebUserActionLogEvent.OPEN_COPY_MODAL);var w={user:o,files:m,onSuccess:function(e){var r=E.countFilesAndFolders(s),n=r.num_files_selected,i=r.num_folders_selected;S.logCopyFiles({uid:o.id,source:a,view_type:l,result:t,num_files_selected:n,num_folders_selected:i}),v.browseActions.selectRowsFromBoltClient(e)},onRequestNotSent:function(){v.browseActions.selectFilesByFqPath({fqPathsToSelect:m.map(function(e){return e.fq_path})})},onUndo:function(){v.browseActions.selectRowsFromBoltClient(m)}},F=f?D.getFolderContentsAPIv2:D.getFolderContents;_.showMoveDialog({operation:V.Operation.COPY,modalName:h.ModalName.COPY,user:o,entries:m,initialFolderSelection:c.currentFQPath,apiClient:{moveToFolder:function(e){var o=r.__assign({},w,{newPath:e,checkFSWs:!0,useApiV2:p});return I.copyFiles(o),Promise.resolve()},getFolderContents:F,getFolderSuggestion:D.getFolderSuggestion},onSuccess:n.noop,onCancel:n.noop,showFolderSuggestion:!0,createNewFolderInMoveDialog:!0})}},De=function(){return function(){m.showOverquota("wb_oq_mv_cp")}},Ve=function(e){var o=e.args;return function(){var e=o.actionHandlers,r=o.files,s=o.firstFile,n=o.isSearchMode,t=o.useSearchSuccessBanner,i=o.expBrowseSuccessBanner,a=r.toArray();pe({result:s,args:o,action_type:ie.WebUserActionLogEvent.RESTORE}),Xe(t,n,i,ie.WebUserActionLogEvent.RESTORE),e.onRestore(a)}},We=function(e){return function(){var o=a.browse_uri_for_fq_path(e.user,e.firstFile.fq_path);o.setQuery({rewind:"true"}),le.replace_location(o.toString())}},qe=function(e){return function(){var o=e.user,r=e.context,s=e.firstFile,n=s.fq_path.toLowerCase(),t=r.inactiveNSIDByFQPath[n];t&&ee.asyncMountSharedFolder(t,o.role,oe.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,!1,null,!0)}},ze=function(e){return function(){var o=e.user,r=e.firstFile,s=e.isSearchMode,n=e.useSearchSuccessBanner,t=e.expBrowseSuccessBanner;pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.VERSIONS}),$e(n,s,t,ie.WebUserActionLogEvent.VERSIONS);var i=a.getFileHistoryUrl({fqPath:r.fq_path,userId:o.id});le.redirect(i)}},He=function(e){return function(){var o=e.actionHandlers,r=e.firstFile,s=e.files,n=e.isSearchMode,t=e.useSearchSuccessBanner,i=e.expBrowseSuccessBanner;pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.DELETE}),Xe(t,n,i,ie.WebUserActionLogEvent.DELETE),o.onDelete(s.toArray())}},Qe=function(e){return function(){var o=e.actionHandlers,r=e.files,s=e.firstFile,n=e.isSearchMode,t=e.useSearchSuccessBanner,i=e.expBrowseSuccessBanner;pe({result:s,args:e,action_type:ie.WebUserActionLogEvent.PERMANENT_DELETE}),Xe(t,n,i,ie.WebUserActionLogEvent.PERMANENT_DELETE),o.onPermanentDelete(r.toArray())}},Ge=function(e){return function(){var o=e.firstFile;pe({result:o,args:e,action_type:ie.WebUserActionLogEvent.EVENTS}),le.redirect("/events?ns="+o.target_ns)}},Ke=function(e,o){return function(){var r=e.firstFile,s=e.files;pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.CALCULATE_SIZE}),o.showFolderCalcSize?v.browseActions.fetchMultipleFolderSizes({files:s}):v.browseActions.fetchFolderSizes({file:r})}},Ye=function(e){return function(){var o=e.user,r=e.context;ee.asyncGoToContentManagerForPath({isLimitedTeam:te.Viewer.get_viewer().team_is_limited,containingFolder:r.currentFQPath,isCDM:o.is_cdm_member})}},Je=function(e){return function(){var o=e.files,r=e.firstFile,s=q.getStoreForFolderOverview();s.dispatch(W.addContentReferences({folderFileId:A.folderOverviewFolderFileId(s.getState()),fileIds:o.toArray().map(z.fileToContentReferenceId),componentNamespace:g.BrowseFolderOverviewComponentNamespace})),pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.FOLDER_OVERVIEW_PIN})}},je=function(e){return function(){var o=e.files,r=e.firstFile,s=e.user,n=e.context,t=function(s){q.getStoreForFolderOverview().dispatch(W.addContentReferencesForPath({files:o.toArray(),path:s})),pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.FOLDER_OVERVIEW_PIN})};ue.asyncShowPinToModal({user:s,path:n.currentFQPath,files:o.toArray(),onFolderSelected:t,isCurrentPathReadOnly:!n.isCurrentPathWriteable()})}},Ze=function(e){return function(){var o=e.files,r=e.firstFile,s=q.getStoreForFolderOverview();s.dispatch(W.removeContentReferences({folderFileId:A.folderOverviewFolderFileId(s.getState()),fileIds:o.toArray().map(z.fileToContentReferenceId),componentNamespace:g.BrowseFolderOverviewComponentNamespace})),pe({result:r,args:e,action_type:ie.WebUserActionLogEvent.FOLDER_OVERVIEW_UNPIN})}},Xe=function(e,o,r,s){e&&o?H.setSearchSuccessBannerVisible():r!==$.BrowseSuccessBannerVariants.V2||o||H.setBrowseSuccessBannerVisible(s)},$e=function(e,o,r,s){e&&o&&H.setSearchSuccessBannerVisible(),r!==$.BrowseSuccessBannerVariants.V2||o||H.setBrowseSuccessBannerVisible(s)},eo=function(e){return function(){M.asyncOpenPreview({containerId:g.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[e.firstFile],indexOfPreviewFile:0,shouldFocusComment:!1,user:e.user,onFileViewerDidMount:M.hideElementsBehindFileViewer,onFileViewerUnmount:M.showElementsBehindFileViewer,fileViewAction:ae.FileViewActionType.CLICK,fileViewOrigin:ae.FileViewOriginType.BROWSE,fileViewTarget:ae.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})}},oo=function(e){return function(){var o=e.user.id,r=e.files.map(function(e){return{file_id:e.file_id,destination_path:d.filename(e.ns_path)}}).toArray();G.Snackbar.sync(ce._("Creating new transfer...",{comment:"Message shown when creating a new transfer from file list on web"}),!1,"create-transfer"),P.createTransfer(o,k.generateTransferTrackingId()).then(function(e){if(!e.transfer)return Promise.reject();var s=e.transfer.transfer_id;return P.addFilesById(o,s,r).then(function(){le.redirect(B.editTransferUrl(s,{referrer:"browse",logCreateTransferEvent:!0}))})}).catch(function(){G.Snackbar.fail(ce._("Unable to create transfer",{comment:"Error message shown when creating a new transfer from file list on web"}),"create-transfer")})}},ro=function(e){return function(){U.showFileLockConfirmModal(e.user.id,e.firstFile),pe({result:e.firstFile,args:e,action_type:ie.WebUserActionLogEvent.LOCK_FILE})}},so=function(e){return function(){U.asyncUnlockFile(e.user.id,[e.firstFile]),pe({result:e.firstFile,args:e,action_type:ie.WebUserActionLogEvent.UNLOCK_FILE})}
},no=function(e){return function(){U.asyncRequestUnlockFile(e.user.id,[e.firstFile]),pe({result:e.firstFile,args:e,action_type:ie.WebUserActionLogEvent.REQUEST_UNLOCK_FILE})}};o.getActionsForFileCollection=Fe});
//# sourceMappingURL=file_actions.min.js-vflwZd4QZ.map