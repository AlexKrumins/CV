define(["require","exports","tslib","modules/clean/api_v2/noauth_client","modules/clean/api_v2/user_client","modules/clean/api_v2/datetime","modules/clean/react/file_transfers/redux/types","file-transfers/common/constants","modules/clean/filepath","modules/clean/viewer"],function(e,r,t,n,s,i,a,o,c,u){"use strict";function _(e){return null!=e.error&&null!=e.error.error_type}function l(e,r){return t.__awaiter(this,void 0,Promise,function(){return t.__generator(this,function(t){switch(t.label){case 0:return[4,(new s.UserApiV2Client).ns("folders_info").rpc("get_folder_sizes",{paths:r},{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function f(e,r,i){return t.__awaiter(this,void 0,Promise,function(){var a;return t.__generator(this,function(t){switch(t.label){case 0:return a={transfer_id:r,password:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("auth_with_password",a,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("auth_with_password_logged_out",a,{})];case 3:return[2,t.sent()]}})})}function d(e,r){return t.__awaiter(this,void 0,Promise,function(){var n,i;return t.__generator(this,function(t){switch(t.label){case 0:return n=function(e){switch(e){case a.TransferListView.Active:return{".tag":"active"};case a.TransferListView.Expired:return{".tag":"expired"}}},i={view:n(r)},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("list",i,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function p(e,r){return t.__awaiter(this,void 0,Promise,function(){var n;return t.__generator(this,function(t){switch(t.label){case 0:return n={},r&&(n.client_generated_tracking_id=r),[4,(new s.UserApiV2Client).ns("file_transfers").rpc("create",n,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function h(e,r){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/list",i,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/list_logged_out",i,{})];case 3:return[2,t.sent()]}})})}function w(e,r,i){return t.__awaiter(this,void 0,Promise,function(){var a;return t.__generator(this,function(t){switch(t.label){case 0:return a={transfer_id:r,requested_files_by_id:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/download",a,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("files/download_logged_out",a,{})];case 3:return[2,t.sent()]}})})}function v(e,r,n,i,a){return t.__awaiter(this,void 0,Promise,function(){var o,_,l,f,d,p;return t.__generator(this,function(t){switch(t.label){case 0:o=new s.UserApiV2Client,_=u.Viewer.get_viewer().get_user_by_id(e),l=n,_.is_cdm_member&&(l=_.cdm_tmf_path+c.normalize(n)),f={transfer_id:r,destination_path:c.normalize(l)+c.normalize(i),requested_files_by_id:a},t.label=1;case 1:return t.trys.push([1,4,,7]),[4,o.ns("files").rpc("create_folder_v2",{path:c.normalize(l)},{subjectUserId:e})];case 2:return t.sent(),[4,o.ns("file_transfers").rpc("files/save_to_dropbox",f,{subjectUserId:e})];case 3:return[2,t.sent()];case 4:return d=t.sent(),d.error&&d.error.path&&d.error.path?(p=d.error.path,"conflict"!==p[".tag"]?[3,6]:[4,o.ns("file_transfers").rpc("files/save_to_dropbox",f,{subjectUserId:e})]):[3,6];case 5:return[2,t.sent()];case 6:throw new Error("saveToDropbox failed to create parent folder");case 7:return[2]}})})}function b(e,r,n){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r||void 0,files_to_add:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/add_by_id",i,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function m(e,r,n){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r,files_to_remove:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/remove",i,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function g(e,r,n){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r,requested_files_by_path:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/remove",i,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function U(e,r,n){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r||void 0,files_to_add:n},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("files/add_by_blocks",i,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function A(e,r){return t.__awaiter(this,void 0,Promise,function(){var n;return t.__generator(this,function(t){switch(t.label){case 0:return n={library_assets_to_add:r},[4,(new s.UserApiV2Client).ns("premium_kit").rpc("asset_libraries/add_assets",n,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function I(e,r){return t.__awaiter(this,void 0,Promise,function(){var n;return t.__generator(this,function(t){switch(t.label){case 0:return n={transfer_id:r},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("share",n,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function V(e,r,n,a){return t.__awaiter(this,void 0,Promise,function(){var o;return t.__generator(this,function(t){switch(t.label){case 0:return o={expiration_time_update:{".tag":"expiration_time",expiration_time:i.formatTimestamp(n)},transfer_id:r},void 0!==a&&(o.password_update=""===a?{".tag":"no_password"}:{".tag":"password",password:a}),[4,(new s.UserApiV2Client).ns("file_transfers").rpc("update_metadata",o,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function C(e,r,n){return t.__awaiter(this,void 0,Promise,function(){var i,a,o;return t.__generator(this,function(t){switch(t.label){case 0:return i=r?r.background_id:void 0,a=void 0,void 0!==n&&(a=null===n?{".tag":"clear_logo"}:{".tag":"logo_asset_id",logo_asset_id:n}),o={background_id:i,logo_update:a},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("update_user_config",o,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function P(e,r,i){return t.__awaiter(this,void 0,Promise,function(){var a;return t.__generator(this,function(t){switch(t.label){case 0:return a={transfer_id:r,event_name:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("user_metrics/log_event",a,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("user_metrics/log_event_logged_out",a,{})];case 3:return[2,t.sent()]}})})}function j(e,r){return t.__awaiter(this,void 0,Promise,function(){var n;return t.__generator(this,function(t){switch(t.label){case 0:return n={transfer_id:r},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("delete",n,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function y(e,r,n,i){return t.__awaiter(this,void 0,Promise,function(){var a;return t.__generator(this,function(t){switch(t.label){case 0:return a={recipients:r,message_body:n,transfer_id:i},[4,(new s.UserApiV2Client).ns("file_transfers").rpc("email_recipients",a,{subjectUserId:e})];case 1:return[2,t.sent()]}})})}function x(e,r,i){return t.__awaiter(this,void 0,Promise,function(){var a,c;return t.__generator(this,function(t){switch(t.label){case 0:return a=r===o.NOT_APPLICABLE_SATISFACTION_RATING_VALUE?{".tag":"not_applicable"}:{".tag":"value",value:r},c={satisfaction_rating:a,comments:i},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("submit_feedback",c,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("submit_feedback_logged_out",c,{})];case 3:return[2,t.sent()]}})})}function T(e,r){return t.__awaiter(this,void 0,Promise,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return i={transfer_id:r.transferId,event_name:r.eventName,file_expiration:r.fileExpiration,file_transfer_flow:r.fileTransferFlow,client_generated_transfer_tracking_id:r.clientGeneratedTransferTrackingId,extra:JSON.stringify(r.extra)},e?[4,(new s.UserApiV2Client).ns("file_transfers").rpc("product_analytics/log_event",i,{subjectUserId:e})]:[3,2];case 1:return[2,t.sent()];case 2:return[4,(new n.NoAuthApiV2Client).ns("file_transfers").rpc("product_analytics/log_event_logged_out",i,{})];case 3:return[2,t.sent()]}})})}function k(e){return t.__awaiter(this,void 0,Promise,function(){return t.__generator(this,function(r){switch(r.label){case 0:return[4,(new s.UserApiV2Client).ns("file_transfers").rpc("teams/opt_in",{},{subjectUserId:e})];case 1:return[2,r.sent()]}})})}Object.defineProperty(r,"__esModule",{value:!0}),a=t.__importStar(a),r.isApiErrorResult=_,r.getFolderSizes=l,r.authWithPassword=f,r.fetchTransfersList=d,r.createTransfer=p,r.fetchFiles=h,r.downloadFiles=w,r.saveToDropbox=v,r.addFilesById=b,r.removeFileById=m,r.removeFileByPath=g,r.addFilesByBlocks=U,r.addPremiumAsset=A,r.share=I,r.updateMetadata=V,r.updateUserConfig=C,r.logUserMetricsEvent=P,r.deleteTransfer=j,r.emailRecipients=y,r.submitFeedback=x,r.logProductAnalyticsEvent=T,r.teamsOptIn=k});
//# sourceMappingURL=api.min.js-vflMnk8Cv.map